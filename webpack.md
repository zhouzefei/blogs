
> webpackå¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œé€’å½’åœ°æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆ1ä¸ªæˆ–å¤šä¸ªbundle

#### ğŸ”¥æ ¸å¿ƒæ¦‚å¿µ
- å…¥å£ï¼šæ„å»ºå†…éƒ¨ä¾èµ–å›¾çš„å¼€å§‹
- è¾“å‡ºï¼šå‘ç¡¬ç›˜å†™å…¥ç¼–è¯‘æ–‡ä»¶ã€‚å‘Šè¯‰webpackåœ¨å“ªé‡Œè¾“å‡ºå®ƒæ‰€åˆ›å»ºåœ°bundles
- loaderï¼šè½¬æ¢æŸäº›ç±»å‹çš„æ¨¡å—ã€‚å°†æ‰€æœ‰ç±»å‹åœ°æ–‡ä»¶è½¬æ¢ä¸ºwebpackèƒ½å¤Ÿå¤„ç†åœ°æœ‰æ•ˆæ¨¡å—ã€‚
  - testï¼šç”¨äºæ ‡è¯†åº”è¯¥è¢«å¯¹åº”åœ°loaderè¿›è¡Œè½¬æ¢åœ°æŸä¸ªæˆ–æŸäº›æ–‡ä»¶ã€‚
  - useï¼šè¿›è¡Œè½¬æ¢æ—¶åº”è¯¥ä½¿ç”¨å“ªä¸ªloaderã€‚
  - module.rulesä¸­çš„å³ï¼šå½“ä½ é‡åˆ°ç¬¦åˆtestè·¯å¾„æ—¶ï¼Œåœ¨å¯¹å®ƒæ‰“åŒ…ä¹‹å‰ï¼Œå…ˆä½¿ç”¨loaderè½¬æ¢ä¸€ä¸‹
- æ’ä»¶ï¼šä»æ‰“åŒ…ä¼˜åŒ–å’Œå‹ç¼©ï¼Œä¸€ç›´åˆ°é‡æ–°å®šä¹‰ç¯å¢ƒä¸­çš„å˜é‡ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†å„ç§å„æ ·çš„ä»»åŠ¡



#### â›½ï¸webpackçš„åŸºæœ¬æ„å»ºæµç¨‹
![Alt text](https://img.alicdn.com/tps/TB1GVGFNXXXXXaTapXXXXXXXXXX-4436-4244.jpg)

Compilerï¼šåŒ…å«å½“å‰è¿è¡ŒWebpackçš„é…ç½®ï¼ŒåŒ…æ‹¬entryã€outputã€loadersç­‰é…ç½®ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨å¯åŠ¨Webpackæ—¶è¢«åºåˆ—åŒ–ï¼Œè€Œä¸”æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚Pluginå¯ä»¥é€šè¿‡è¯¥å¯¹è±¡è·å–åˆ°Webpackçš„é…ç½®ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚

Compilationï¼šå¯¹è±¡ä»£è¡¨æŸä¸ªç‰ˆæœ¬çš„èµ„æºå¯¹åº”çš„ç¼–è¯‘è¿›ç¨‹ã€‚å½“ä½¿ç”¨Webpackçš„developmentä¸­é—´ä»¶æ—¶ï¼Œæ¯æ¬¡æ£€æµ‹åˆ°é¡¹ç›®æ–‡ä»¶æœ‰æ”¹åŠ¨å°±ä¼šåˆ›å»ºä¸€ä¸ªcompilationï¼Œè¿›è€Œèƒ½å¤Ÿé’ˆå¯¹æ”¹åŠ¨ç”Ÿäº§å…¨æ–°çš„ç¼–è¯‘æ–‡ä»¶ã€‚compilationå¯¹è±¡åŒ…å«å½“å‰æ¨¡å—èµ„æºã€å¾…ç¼–è¯‘æ–‡ä»¶ã€æœ‰æ”¹åŠ¨çš„æ–‡ä»¶å’Œç›‘å¬ä¾èµ–çš„æ‰€æœ‰ä¿¡æ¯ã€‚

> Compiler å’Œ Compilation çš„åŒºåˆ«åœ¨äºï¼šCompiler ä»£è¡¨äº†æ•´ä¸ª Webpack ä»å¯åŠ¨åˆ°å…³é—­çš„ç”Ÿå‘½å‘¨æœŸï¼Œè€Œ Compilation åªæ˜¯ä»£è¡¨äº†ä¸€æ¬¡æ–°çš„ç¼–è¯‘



ç»¼ä¸Šé€šä¿—çš„æè¿°ï¼š
1. åˆå§‹åŒ–é…ç½®æ–‡ä»¶
2. ç”Ÿæˆcompilerå¯¹è±¡,è´Ÿè´£æ–‡ä»¶ç›‘å¬å’Œå¯åŠ¨ç¼–è¯‘
3. åˆå§‹åŒ–æ’ä»¶ï¼Œè®©æ’ä»¶å¯ä»¥ç›‘å¬åç»­çš„æ‰€æœ‰äº‹ä»¶èŠ‚ç‚¹
4. runé˜¶æ®µ è§¦å‘compileï¼Œå¯åŠ¨ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚
5. compilationå¯¹è±¡ç»„ç»‡æ•´ä¸ªç¼–è¯‘è¿‡ç¨‹è¿›è¡Œç¼–è¯‘ã€‚ä» Entry å‘å‡ºï¼Œé’ˆå¯¹æ¯ä¸ª Module ä¸²è¡Œè°ƒç”¨å¯¹åº”çš„ Loader å»ç¿»è¯‘æ–‡ä»¶å†…å®¹ï¼Œå†æ‰¾åˆ°è¯¥ Module ä¾èµ–çš„ Moduleï¼Œé€’å½’åœ°è¿›è¡Œç¼–è¯‘å¤„ç†ã€‚
6. sealé€æ¬¡å¯¹æ¯ä¸ªMoudleå’Œchunkè¿›è¡Œæ•´ç†ï¼Œç”Ÿæˆç¼–è¯‘åçš„æºç ã€‚
7. ç¼–è¯‘å®Œæˆå†™å…¥åˆ°ç£ç›˜

<br/>

### webpackçš„runtimeå’Œmanifest ç®¡ç†æ‰€æœ‰æ¨¡å—çš„äº¤äº’

#### â­ï¸Runtime
åœ¨æµè§ˆå™¨è¿è¡Œæ—¶ï¼Œwebpackç”¨æ¥è¿æ¥æ¨¡å—åŒ–çš„åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ä»£ç ï¼ŒruntimeåŒ…å«ï¼šåœ¨æ¨¡å—äº¤äº’æ—¶ï¼Œè¿æ¥æ¨¡å—æ‰€éœ€çš„åŠ è½½å’Œè§£æé€»è¾‘ã€‚åŒ…æ‹¬æµè§ˆå™¨ä¸­å·²åŠ è½½æ¨¡å—çš„è¿æ¥ï¼Œä»¥åŠæ‡’åŠ è½½æ¨¡å—çš„æ‰§è¡Œé€»è¾‘
<br/>

#### â­ï¸Manifest
å½“ç¼–è¯‘å™¨å¼€å§‹æ‰§è¡Œã€è§£æå’Œæ˜ å°„åº”ç”¨ç¨‹åºæ—¶ï¼Œä¼šä¿ç•™æ‰€æœ‰æ¨¡å—çš„è¯¦ç»†è¦ç‚¹ã€‚è¿™ä¸ªæ•°æ®é›†åˆç§°ä¸ºâ€œManifestâ€,å½“å®Œæˆæ‰“åŒ…å¹¶å‘é€åˆ°æµè§ˆå™¨æ—¶ï¼Œä¼šåœ¨è¿è¡Œæ—¶é€šè¿‡Manifestæ¥è§£æå’ŒåŠ è½½æ¨¡å—ã€‚æ— è®ºé€‰æ‹©importæˆ–requireè¯­å¥ï¼Œç°åœ¨éƒ½è½¬æ¢ä¸º__webpack_require_æ–¹æ³•ï¼Œæ­¤æ–¹æ³•æŒ‡å‘æ¨¡å—æ ‡è¯†ç¬¦ï¼Œé€šè¿‡manifestä¸­çš„æ•°æ®ï¼Œruntimeå°†èƒ½å¤ŸæŸ¥è¯¢æ¨¡å—æ ‡è¯†ç¬¦ï¼Œæ£€ç´¢å‡ºèƒŒåå¯¹åº”çš„æ¨¡å—


<br/>

#### ä»¥ä¸Šæ˜¯å¯¹æ•´ä¸ªwebpackå·¥ä½œè¿‡ç¨‹çš„ä¸€ä¸ªå¤§æ¦‚æè¿°,é‚£ä¹ˆç»“åˆå½“å‰çš„é¡¹ç›®ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åšäº›ä»€ä¹ˆï¼Ÿ

1. redux æ— æ³•åœ¨æµè§ˆå™¨ä¸­è°ƒè¯•ã€‚å¯¹äºä¸€äº›æ•°æ®äº¤äº’ç±»çš„è°ƒè¯•æˆ–è€…bugå®šä½éå¸¸ä¸ä¾¿ã€‚
   ![Alt text](./images/webpack/reduxTree.png)
   è§£å†³æ–¹æ¡ˆï¼šå°†dvaä»webpack.dllé…ç½®æ–‡ä»¶ä¸­åˆ é™¤ï¼Œé‡æ–°build:dllå³å¯ã€‚é‚£ä¹ˆdvaåº”è¯¥å¦‚ä½•å¤„ç†ï¼Ÿè¯·çœ‹ä¸‹ä¸€ä¸ªè¯é¢˜ï¼

2. optimization.splitChunks ä¾‹å¦‚ä¸šåŠ¡é€»è¾‘æœªæå–
   ![Alt text](./images/webpack/zipBefore1.png)
   ![Alt text](./images/webpack/zipBefore2.png)
   ![Alt text](./images/webpack/zipBefore3.png)
   æå–åŸåˆ™ï¼š
   - åŸºç¡€ç±»åº“ï¼šreactï¼Œreact-reduxï¼Œreact-router
   - UIåº“ï¼šantdï¼Œantd-icons
   - å…¬å…±ç»„ä»¶åº“ï¼šè‡ªå®šä¹‰çš„å…¬å…±ç»„ä»¶
   - ä½é¢‘ç»„ä»¶
   - ä¸šåŠ¡ä»£ç 
  
   ```javascript
      splitChunks: {
        cacheGroups: {
            antdUI: {
                name: "antdUI",
                priority: 100,
                test: /(antd)/,
                minChunks: 3,
                reuseExistingChunk: true
            },
            asyncModuleCommons: { 
                chunks: "async",
                minChunks: 3,
                test: /(node_modules)/,
                name: "async-module-commons",
                priority: 90,
                reuseExistingChunk: true
            },
            asyncCommons: { 
                chunks: "async",
                minChunks: 3,
                test: /(src)/,
                name: "async-commons",
                priority: 80,
                reuseExistingChunk: true
            }
        }
    }
   ```
   ![Alt text](./images/webpack/zipAfter1.png)
   ![Alt text](./images/webpack/zipAfter2.png)
   
3. runtimeChunk
   1. å½“æ›´æ”¹appçš„æ—¶å€™runtimeä¸ç»„ä»¶ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚mainçš„hashå‘ç”Ÿå˜åŒ–
   2. å½“ç»„ä»¶æ”¹å˜æ˜¯mainçš„hashä¸å˜åŒ–ï¼Œç»„ä»¶å’Œruntimeå‘ç”Ÿå˜åŒ–
   
4. moment è¯­è¨€åŒ…
   ```new webpack.ContextReplacementPlugin(/moment[\/\\]locale$/, /zh-en|en-us/)```

5. buildå¤ªæ…¢ã€‚
   å¤šçº¿ç¨‹ï¼šhappypackã€webpack-parallel-uglify-plugin è¯•äº†ä¸‹æ²¡çœ‹åˆ°æ˜¾è‘—çš„æ•ˆæœ
   
   